(window["webpackJsonp"] = window["webpackJsonp"] || []).push([[22],{

/***/ "./js/modules/exporter/html/index.js":
/*!*******************************************!*\
  !*** ./js/modules/exporter/html/index.js ***!
  \*******************************************/
/*! exports provided: HTMLExporter */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"HTMLExporter\", function() { return HTMLExporter; });\n/* harmony import */ var downloadjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! downloadjs */ \"./node_modules/downloadjs/download.js\");\n/* harmony import */ var downloadjs__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(downloadjs__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var pretty__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! pretty */ \"./node_modules/pretty/index.js\");\n/* harmony import */ var pretty__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(pretty__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _tools_file__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../tools/file */ \"./js/modules/exporter/tools/file.js\");\n/* harmony import */ var _tools_html__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../tools/html */ \"./js/modules/exporter/tools/html.js\");\n/* harmony import */ var _tools_zip__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../tools/zip */ \"./js/modules/exporter/tools/zip.js\");\n/* harmony import */ var _tools_doc_contents__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../tools/doc_contents */ \"./js/modules/exporter/tools/doc_contents.js\");\n/* harmony import */ var _html_templates__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../html/templates */ \"./js/modules/exporter/html/templates.js\");\n/* harmony import */ var _common__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../common */ \"./js/modules/common/index.js\");\n/* harmony import */ var _tools_dom_export__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../tools/dom_export */ \"./js/modules/exporter/tools/dom_export.js\");\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\n\n\n\n\n\n\n\n\n\nvar HTMLExporter =\n/*#__PURE__*/\nfunction (_BaseDOMExporter) {\n  _inherits(HTMLExporter, _BaseDOMExporter);\n\n  function HTMLExporter(schema, doc, bibDB, imageDB, citationStyles, citationLocales, documentStyles, staticUrl) {\n    var _this;\n\n    _classCallCheck(this, HTMLExporter);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(HTMLExporter).call(this, schema));\n    _this.doc = doc;\n    _this.citationStyles = citationStyles;\n    _this.citationLocales = citationLocales;\n    _this.documentStyles = documentStyles;\n    _this.bibDB = bibDB;\n    _this.imageDB = imageDB;\n    _this.staticUrl = staticUrl;\n    _this.styleSheets = [{\n      filename: \"\".concat(_this.staticUrl, \"css/document.css?v=\").concat(1563278625)\n    }];\n    _this.removeUrlPrefix = true;\n    return _this;\n  }\n\n  _createClass(HTMLExporter, [{\n    key: \"init\",\n    value: function init() {\n      var _this2 = this;\n\n      Object(_common__WEBPACK_IMPORTED_MODULE_7__[\"addAlert\"])('info', \"\".concat(this.doc.title, \": \").concat(gettext('HTML export has been initiated.')));\n      this.docContents = Object(_tools_doc_contents__WEBPACK_IMPORTED_MODULE_5__[\"removeHidden\"])(this.doc.contents, false);\n      var docStyle;\n      return this.addStyle().then(function (style) {\n        return docStyle = style;\n      }).then(function () {\n        return _this2.joinDocumentParts();\n      }).then(function () {\n        return _this2.fillToc();\n      }).then(function () {\n        return _this2.postProcess();\n      }).then(function (_ref) {\n        var title = _ref.title,\n            html = _ref.html,\n            math = _ref.math,\n            imageFiles = _ref.imageFiles;\n        return _this2.save({\n          title: title,\n          html: html,\n          math: math,\n          imageFiles: imageFiles,\n          docStyle: docStyle\n        });\n      });\n    }\n  }, {\n    key: \"addStyle\",\n    value: function addStyle() {\n      var _this3 = this;\n\n      var docStyle = this.documentStyles.find(function (docStyle) {\n        return docStyle.filename === _this3.doc.settings.documentstyle;\n      });\n      var docStyleCSS = \"\\n        \".concat(docStyle.fonts.map(function (font) {\n        return \"@font-face {\".concat(font[1].replace('[URL]', _this3.removeUrlPrefix ? font[0].split('/').pop() : font[0]), \"}\");\n      }).join('\\n'), \"\\n\\n        \").concat(docStyle.contents, \"\\n        \");\n      this.styleSheets.push({\n        contents: docStyleCSS\n      });\n      return Promise.resolve(docStyle);\n    }\n  }, {\n    key: \"postProcess\",\n    value: function postProcess() {\n      var title = this.doc.title;\n      var math = this.contents.querySelectorAll('.equation, .figure-equation').length ? true : false;\n\n      if (math) {\n        this.styleSheets.push({\n          filename: \"\".concat(this.staticUrl, \"css/libs/mathlive/mathlive.css?v=\").concat(1563278625)\n        });\n      }\n\n      var imageFiles = this.removeUrlPrefix ? Object(_tools_html__WEBPACK_IMPORTED_MODULE_3__[\"modifyImages\"])(this.contents) : [];\n      var html = Object(_html_templates__WEBPACK_IMPORTED_MODULE_6__[\"htmlExportTemplate\"])({\n        part: false,\n        title: title,\n        settings: this.doc.settings,\n        styleSheets: this.styleSheets,\n        contents: this.contents,\n        removeUrlPrefix: this.removeUrlPrefix\n      });\n      return {\n        title: title,\n        html: html,\n        math: math,\n        imageFiles: imageFiles\n      };\n    } // The save function is specific to HTMl saving and therefore assumes that this.removeUrlPrefix === true\n\n  }, {\n    key: \"save\",\n    value: function save(_ref2) {\n      var title = _ref2.title,\n          html = _ref2.html,\n          math = _ref2.math,\n          imageFiles = _ref2.imageFiles,\n          docStyle = _ref2.docStyle;\n      var fontFiles = docStyle.fonts.map(function (font) {\n        return {\n          filename: font[0].split('/').pop(),\n          url: font[0]\n        };\n      });\n      var binaryFiles = fontFiles.concat(imageFiles);\n      var textFiles = [{\n        filename: 'document.html',\n        contents: pretty__WEBPACK_IMPORTED_MODULE_1___default()(this.replaceImgSrc(html), {\n          ocd: true\n        })\n      }];\n      this.styleSheets.forEach(function (styleSheet) {\n        if (styleSheet.contents && styleSheet.filename) {\n          textFiles.push(styleSheet);\n        }\n      });\n      var includeZips = [];\n\n      if (math) {\n        includeZips.push({\n          'directory': '',\n          'url': \"\".concat(this.staticUrl, \"zip/mathlive_style.zip?v=\").concat(1563278625)\n        });\n      }\n\n      var zipper = new _tools_zip__WEBPACK_IMPORTED_MODULE_4__[\"ZipFileCreator\"](textFiles, binaryFiles, includeZips);\n      zipper.init().then(function (blob) {\n        return downloadjs__WEBPACK_IMPORTED_MODULE_0___default()(blob, Object(_tools_file__WEBPACK_IMPORTED_MODULE_2__[\"createSlug\"])(title) + '.html.zip', 'application/zip');\n      });\n    }\n  }]);\n\n  return HTMLExporter;\n}(_tools_dom_export__WEBPACK_IMPORTED_MODULE_8__[\"BaseDOMExporter\"]);\n\n//# sourceURL=webpack:///./js/modules/exporter/html/index.js?");

/***/ }),

/***/ "./js/modules/exporter/html/templates.js":
/*!***********************************************!*\
  !*** ./js/modules/exporter/html/templates.js ***!
  \***********************************************/
/*! exports provided: htmlExportTemplate */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"htmlExportTemplate\", function() { return htmlExportTemplate; });\n/* harmony import */ var _common__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../common */ \"./js/modules/common/index.js\");\n\n/** A template for HTML export of a document. */\n\nvar htmlExportTemplate = function htmlExportTemplate(_ref) {\n  var title = _ref.title,\n      styleSheets = _ref.styleSheets,\n      part = _ref.part,\n      contents = _ref.contents,\n      removeUrlPrefix = _ref.removeUrlPrefix;\n  return \"<!DOCTYPE html>\\n<html>\\n    <head>\\n        <title>\".concat(Object(_common__WEBPACK_IMPORTED_MODULE_0__[\"escapeText\"])(title), \"</title>\\n\").concat(styleSheets.map(function (sheet) {\n    return sheet.filename ? \"<link rel=\\\"stylesheet\\\" type=\\\"text/css\\\" href=\\\"\".concat(removeUrlPrefix ? sheet.filename.split('/').pop() : sheet.filename, \"\\\" />\") : \"<style>\".concat(sheet.contents, \"</style>\");\n  }).join(''), \"\\n    </head>\\n    <body class=\\\"article\\\">\\n\").concat(part && part.length ? \"<h1 class=\\\"part\\\">\".concat(Object(_common__WEBPACK_IMPORTED_MODULE_0__[\"escapeText\"])(part), \"</h1>\") : '', \"\\n        \").concat(contents.innerHTML, \"\\n    </body>\\n</html>\");\n};\n\n//# sourceURL=webpack:///./js/modules/exporter/html/templates.js?");

/***/ }),

/***/ "./js/modules/exporter/print/index.js":
/*!********************************************!*\
  !*** ./js/modules/exporter/print/index.js ***!
  \********************************************/
/*! exports provided: PrintExporter */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"PrintExporter\", function() { return PrintExporter; });\n/* harmony import */ var vivliostyle_print__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! vivliostyle-print */ \"./node_modules/vivliostyle-print/dist/index.es6.js\");\n/* harmony import */ var _schema_i18n__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../schema/i18n */ \"./js/modules/schema/i18n.js\");\n/* harmony import */ var _html__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../html */ \"./js/modules/exporter/html/index.js\");\n/* harmony import */ var _common__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../common */ \"./js/modules/common/index.js\");\n/* harmony import */ var _tools_doc_contents__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../tools/doc_contents */ \"./js/modules/exporter/tools/doc_contents.js\");\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _get(target, property, receiver) { if (typeof Reflect !== \"undefined\" && Reflect.get) { _get = Reflect.get; } else { _get = function _get(target, property, receiver) { var base = _superPropBase(target, property); if (!base) return; var desc = Object.getOwnPropertyDescriptor(base, property); if (desc.get) { return desc.get.call(receiver); } return desc.value; }; } return _get(target, property, receiver || target); }\n\nfunction _superPropBase(object, property) { while (!Object.prototype.hasOwnProperty.call(object, property)) { object = _getPrototypeOf(object); if (object === null) break; } return object; }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\n\n\n\n\n\nvar PrintExporter =\n/*#__PURE__*/\nfunction (_HTMLExporter) {\n  _inherits(PrintExporter, _HTMLExporter);\n\n  function PrintExporter(schema, doc, bibDB, imageDB, citationStyles, citationLocales, documentStyles, staticUrl) {\n    var _this;\n\n    _classCallCheck(this, PrintExporter);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(PrintExporter).call(this, schema, doc, bibDB, imageDB, citationStyles, citationLocales, documentStyles, staticUrl));\n    _this.staticUrl = staticUrl;\n    _this.removeUrlPrefix = false;\n\n    _this.styleSheets.push({\n      contents: \"a.fn {\\n                -adapt-template: url(data:application/xml,\".concat(encodeURI('<html xmlns=\"http://www.w3.org/1999/xhtml\" xmlns:s=\"http://www.pyroxy.com/ns/shadow\"><head><style>.footnote-content{float:footnote}</style></head><body><s:template id=\"footnote\"><s:content/><s:include class=\"footnote-content\"/></s:template></body></html>#footnote'), \");\\n                text-decoration: none;\\n                color: inherit;\\n                vertical-align: baseline;\\n                font-size: 70%;\\n                position: relative;\\n                top: -0.3em;\\n                \\n            }\\n            section[role=doc-footnote] > *:first-child:before {\\n                counter-increment: footnote-counter;\\n                content: counter(footnote-counter) \\\". \\\";\\n            }\\n            section.fnlist {\\n                display: none;\\n            }\\n            section:footnote-content {\\n                display: block;\\n                font-style:normal;\\n                font-weight:normal;\\n                text-decoration:none;\\n            }\\n            .table-of-contents a {\\n            \\tdisplay: inline-flex;\\n            \\twidth: 100%;\\n            \\ttext-decoration: none;\\n            \\tcolor: currentColor;\\n            \\tbreak-inside: avoid;\\n            \\talign-items: baseline;\\n            }\\n            .table-of-contents a::before {\\n            \\tmargin-left: 1px;\\n            \\tmargin-right: 1px;\\n            \\tborder-bottom: solid 1px lightgray;\\n            \\tcontent: \\\"\\\";\\n            \\torder: 1;\\n            \\tflex: auto;\\n            }\\n            .table-of-contents a::after {\\n            \\ttext-align: right;\\n            \\tcontent: target-counter(attr(href, url), page);\\n            \\talign-self: flex-end;\\n            \\tflex: none;\\n            \\torder: 2;\\n            }\\n            @page {\\n                size: \").concat(_schema_i18n__WEBPACK_IMPORTED_MODULE_1__[\"PAPER_SIZES\"].find(function (size) {\n        return size[0] === _this.doc.settings.papersize;\n      })[1], \";\\n                @top-center {\\n                    content: env(doc-title);\\n                }\\n                @bottom-center {\\n                    content: counter(page);\\n                }\\n            }\")\n    });\n\n    return _this;\n  }\n\n  _createClass(PrintExporter, [{\n    key: \"init\",\n    value: function init() {\n      var _this2 = this;\n\n      Object(_common__WEBPACK_IMPORTED_MODULE_3__[\"addAlert\"])('info', \"\".concat(this.doc.title, \": \").concat(gettext('Printing has been initiated.')));\n      this.docContents = Object(_tools_doc_contents__WEBPACK_IMPORTED_MODULE_4__[\"removeHidden\"])(this.doc.contents, false);\n      return this.addStyle().then(function () {\n        return _this2.joinDocumentParts();\n      }).then(function () {\n        return _this2.fillToc();\n      }).then(function () {\n        return _this2.postProcess();\n      }).then(function (_ref) {\n        var html = _ref.html,\n            title = _ref.title;\n        return Object(vivliostyle_print__WEBPACK_IMPORTED_MODULE_0__[\"vivliostylePrint\"])(html, {\n          title: title,\n          resourcesUrl: \"\".concat(_this2.staticUrl, \"vivliostyle-resources/\")\n        });\n      });\n    }\n  }, {\n    key: \"getFootnoteAnchor\",\n    value: function getFootnoteAnchor(counter) {\n      var footnoteAnchor = _get(_getPrototypeOf(PrintExporter.prototype), \"getFootnoteAnchor\", this).call(this, counter); // Add the counter directly into the footnote.\n\n\n      footnoteAnchor.innerHTML = counter;\n      return footnoteAnchor;\n    }\n  }]);\n\n  return PrintExporter;\n}(_html__WEBPACK_IMPORTED_MODULE_2__[\"HTMLExporter\"]);\n\n//# sourceURL=webpack:///./js/modules/exporter/print/index.js?");

/***/ })

}]);