(window["webpackJsonp"] = window["webpackJsonp"] || []).push([[17],{

/***/ "./js/modules/exporter/epub/base.js":
/*!******************************************!*\
  !*** ./js/modules/exporter/epub/base.js ***!
  \******************************************/
/*! exports provided: BaseEpubExporter */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"BaseEpubExporter\", function() { return BaseEpubExporter; });\n/* harmony import */ var _tools_dom_export__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../tools/dom_export */ \"./js/modules/exporter/tools/dom_export.js\");\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\n\nvar BaseEpubExporter =\n/*#__PURE__*/\nfunction (_BaseDOMExporter) {\n  _inherits(BaseEpubExporter, _BaseDOMExporter);\n\n  function BaseEpubExporter() {\n    _classCallCheck(this, BaseEpubExporter);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(BaseEpubExporter).apply(this, arguments));\n  }\n\n  _createClass(BaseEpubExporter, [{\n    key: \"getTimestamp\",\n    value: function getTimestamp() {\n      var today = new Date();\n      var second = today.getUTCSeconds();\n      var minute = today.getUTCMinutes();\n      var hour = today.getUTCHours();\n      var day = today.getUTCDate();\n      var month = today.getUTCMonth() + 1; //January is 0!\n\n      var year = today.getUTCFullYear();\n\n      if (second < 10) {\n        second = '0' + second;\n      }\n\n      if (minute < 10) {\n        minute = '0' + minute;\n      }\n\n      if (hour < 10) {\n        hour = '0' + hour;\n      }\n\n      if (day < 10) {\n        day = '0' + day;\n      }\n\n      if (month < 10) {\n        month = '0' + month;\n      }\n\n      return year + '-' + month + '-' + day + 'T' + hour + ':' + minute + ':' + second + 'Z';\n    }\n  }, {\n    key: \"styleEpubFootnotes\",\n    value: function styleEpubFootnotes(htmlCode) {\n      // Converts RASH style footnotes into epub footnotes.\n      var footnotes = htmlCode.querySelectorAll('section.fnlist section[role=doc-footnote]');\n      var footnoteCounter = 1;\n      footnotes.forEach(function (footnote) {\n        var newFootnote = document.createElement('aside');\n        newFootnote.setAttribute('epub:type', 'footnote');\n        newFootnote.id = footnote.id;\n\n        if (footnote.firstChild) {\n          while (footnote.firstChild) {\n            newFootnote.appendChild(footnote.firstChild);\n          }\n\n          newFootnote.firstChild.innerHTML = footnoteCounter + ' ' + newFootnote.firstChild.innerHTML;\n        } else {\n          newFootnote.innerHTML = '<p>' + footnoteCounter + '</p>';\n        }\n\n        footnote.parentNode.replaceChild(newFootnote, footnote);\n        footnoteCounter++;\n      });\n      var footnoteMarkers = htmlCode.querySelectorAll('a.fn');\n      var footnoteMarkerCounter = 1;\n      footnoteMarkers.forEach(function (fnMarker) {\n        var newFnMarker = document.createElement('sup');\n        var newFnMarkerLink = document.createElement('a');\n        newFnMarkerLink.setAttribute('epub:type', 'noteref');\n        newFnMarkerLink.setAttribute('href', fnMarker.getAttribute('href'));\n        newFnMarkerLink.innerHTML = footnoteMarkerCounter;\n        newFnMarker.appendChild(newFnMarkerLink);\n        fnMarker.parentNode.replaceChild(newFnMarker, fnMarker);\n        footnoteMarkerCounter++;\n      });\n      return htmlCode;\n    }\n  }, {\n    key: \"setLinks\",\n    value: function setLinks(htmlEl, docNum) {\n      var contentItems = [];\n      var title;\n      htmlEl.querySelectorAll('h1,h2,h3,h4,h5,h6').forEach(function (el) {\n        title = el.textContent.trim();\n\n        if (title !== '') {\n          var contentItem = {};\n          contentItem.title = title;\n          contentItem.level = parseInt(el.tagName.substring(1, 2));\n\n          if (docNum) {\n            contentItem.docNum = docNum;\n          }\n\n          if (el.classList.contains('title')) {\n            contentItem.level = 0;\n          }\n\n          contentItem.id = el.id;\n          contentItems.push(contentItem);\n        }\n      });\n      return contentItems;\n    }\n  }, {\n    key: \"orderLinks\",\n    value: function orderLinks(contentItems) {\n      for (var i = 0; i < contentItems.length; i++) {\n        contentItems[i].subItems = [];\n\n        if (i > 0) {\n          for (var j = i - 1; j > -1; j--) {\n            if (contentItems[j].level < contentItems[i].level) {\n              contentItems[j].subItems.push(contentItems[i]);\n              contentItems[i][\"delete\"] = true;\n              break;\n            }\n          }\n        }\n      }\n\n      for (var _i = contentItems.length; _i > -1; _i--) {\n        if (contentItems[_i] && contentItems[_i][\"delete\"]) {\n          delete contentItems[_i][\"delete\"];\n          contentItems.splice(_i, 1);\n        }\n      }\n\n      return contentItems;\n    }\n  }]);\n\n  return BaseEpubExporter;\n}(_tools_dom_export__WEBPACK_IMPORTED_MODULE_0__[\"BaseDOMExporter\"]);\n\n//# sourceURL=webpack:///./js/modules/exporter/epub/base.js?");

/***/ }),

/***/ "./js/modules/exporter/epub/index.js":
/*!*******************************************!*\
  !*** ./js/modules/exporter/epub/index.js ***!
  \*******************************************/
/*! exports provided: EpubExporter */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"EpubExporter\", function() { return EpubExporter; });\n/* harmony import */ var downloadjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! downloadjs */ \"./node_modules/downloadjs/download.js\");\n/* harmony import */ var downloadjs__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(downloadjs__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _tools_json__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../tools/json */ \"./js/modules/exporter/tools/json.js\");\n/* harmony import */ var _tools_file__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../tools/file */ \"./js/modules/exporter/tools/file.js\");\n/* harmony import */ var _tools_html__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../tools/html */ \"./js/modules/exporter/tools/html.js\");\n/* harmony import */ var _tools_zip__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../tools/zip */ \"./js/modules/exporter/tools/zip.js\");\n/* harmony import */ var _templates__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./templates */ \"./js/modules/exporter/epub/templates.js\");\n/* harmony import */ var _common__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../common */ \"./js/modules/common/index.js\");\n/* harmony import */ var _base__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./base */ \"./js/modules/exporter/epub/base.js\");\n/* harmony import */ var _tools_doc_contents__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../tools/doc_contents */ \"./js/modules/exporter/tools/doc_contents.js\");\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\n\n\n\n\n\n\n\n\n\nvar EpubExporter =\n/*#__PURE__*/\nfunction (_BaseEpubExporter) {\n  _inherits(EpubExporter, _BaseEpubExporter);\n\n  function EpubExporter(schema, doc, bibDB, imageDB, citationStyles, citationLocales, staticUrl) {\n    var _this;\n\n    _classCallCheck(this, EpubExporter);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(EpubExporter).call(this, schema));\n    _this.doc = doc;\n    _this.citationStyles = citationStyles;\n    _this.citationLocales = citationLocales;\n    _this.bibDB = bibDB;\n    _this.imageDB = imageDB;\n    _this.staticUrl = staticUrl;\n    _this.shortLang = _this.doc.settings.language.split('-')[0];\n    _this.lang = _this.doc.settings.language;\n    return _this;\n  }\n\n  _createClass(EpubExporter, [{\n    key: \"init\",\n    value: function init() {\n      var _this2 = this;\n\n      Object(_common__WEBPACK_IMPORTED_MODULE_6__[\"addAlert\"])('info', this.doc.title + ': ' + gettext('Epub export has been initiated.'));\n      this.docContents = Object(_tools_doc_contents__WEBPACK_IMPORTED_MODULE_8__[\"removeHidden\"])(this.doc.contents, false);\n      this.joinDocumentParts().then(function () {\n        return _this2.fillToc();\n      }).then(function () {\n        return _this2.exportTwo();\n      });\n    }\n  }, {\n    key: \"exportTwo\",\n    value: function exportTwo() {\n      var styleSheets = []; //TODO: fill style sheets with something meaningful.\n\n      var title = this.doc.title;\n      var contents = this.contents;\n      contents = this.addFigureNumbers(contents);\n      var images = Object(_tools_html__WEBPACK_IMPORTED_MODULE_3__[\"modifyImages\"])(contents);\n      var contentsBody = document.createElement('body');\n\n      while (contents.firstChild) {\n        contentsBody.appendChild(contents.firstChild);\n      }\n\n      var equations = contentsBody.querySelectorAll('.equation, .figure-equation');\n      var math = equations.length ? true : false; // Make links to all H1-3 and create a TOC list of them\n\n      var contentItems = this.orderLinks(this.setLinks(contentsBody));\n      var contentsBodyEpubPrepared = this.styleEpubFootnotes(contentsBody);\n      var xhtmlCode = Object(_templates__WEBPACK_IMPORTED_MODULE_5__[\"xhtmlTemplate\"])({\n        part: false,\n        shortLang: this.shortLang,\n        title: title,\n        styleSheets: styleSheets,\n        math: math,\n        body: Object(_tools_json__WEBPACK_IMPORTED_MODULE_1__[\"obj2Node\"])(Object(_tools_json__WEBPACK_IMPORTED_MODULE_1__[\"node2Obj\"])(contentsBodyEpubPrepared), 'xhtml').innerHTML\n      });\n      xhtmlCode = this.replaceImgSrc(xhtmlCode);\n      var containerCode = Object(_templates__WEBPACK_IMPORTED_MODULE_5__[\"containerTemplate\"])({});\n      var timestamp = this.getTimestamp();\n      var authors = this.docContents.content.reduce(function (authors, part) {\n        if (part.type === 'contributors_part' && part.attrs.metadata === 'authors') {\n          return authors.concat(part.content.map(function (authorNode) {\n            var nameParts = [];\n\n            if (authorNode.attrs.firstname) {\n              nameParts.push(authorNode.attrs.firstname);\n            }\n\n            if (authorNode.attrs.lastname) {\n              nameParts.push(authorNode.attrs.lastname);\n            }\n\n            if (!nameParts.length && authorNode.attrs.institution) {\n              // We have an institution but no names. Use institution as name.\n              nameParts.push(authorNode.attrs.institution);\n            }\n\n            return nameParts.join(' ');\n          }));\n        } else {\n          return authors;\n        }\n      }, []);\n      var keywords = this.docContents.content.reduce(function (keywords, part) {\n        if (part.type === 'tags_part' && part.attrs.metadata === 'keywords') {\n          return keywords.concat(part.content.map(function (keywordNode) {\n            return keywordNode.attrs.tag;\n          }));\n        } else {\n          return keywords;\n        }\n      }, []);\n      var opfCode = Object(_templates__WEBPACK_IMPORTED_MODULE_5__[\"opfTemplate\"])({\n        language: this.lang,\n        title: title,\n        authors: authors,\n        keywords: keywords,\n        idType: 'fidus',\n        id: this.doc.id,\n        date: timestamp.slice(0, 10),\n        // TODO: the date should probably be the original document creation date instead\n        modified: timestamp,\n        styleSheets: styleSheets,\n        math: math,\n        images: images\n      });\n      var ncxCode = Object(_templates__WEBPACK_IMPORTED_MODULE_5__[\"ncxTemplate\"])({\n        shortLang: this.shortLang,\n        title: title,\n        idType: 'fidus',\n        id: this.doc.id,\n        contentItems: contentItems\n      });\n      var navCode = Object(_templates__WEBPACK_IMPORTED_MODULE_5__[\"navTemplate\"])({\n        shortLang: this.shortLang,\n        contentItems: contentItems\n      });\n      var outputList = [{\n        filename: 'META-INF/container.xml',\n        contents: containerCode\n      }, {\n        filename: 'EPUB/document.opf',\n        contents: opfCode\n      }, {\n        filename: 'EPUB/document.ncx',\n        contents: ncxCode\n      }, {\n        filename: 'EPUB/document-nav.xhtml',\n        contents: navCode\n      }, {\n        filename: 'EPUB/document.xhtml',\n        contents: xhtmlCode\n      }];\n\n      for (var i = 0; i < styleSheets.length; i++) {\n        var styleSheet = styleSheets[i];\n        outputList.push({\n          filename: 'EPUB/' + styleSheet.filename,\n          contents: styleSheet.contents\n        });\n      }\n\n      var httpOutputList = [];\n\n      for (var _i = 0; _i < images.length; _i++) {\n        httpOutputList.push({\n          filename: 'EPUB/' + images[_i].filename,\n          url: images[_i].url\n        });\n      }\n\n      var includeZips = [];\n\n      if (math) {\n        includeZips.push({\n          'directory': 'EPUB',\n          'url': \"\".concat(this.staticUrl, \"zip/mathlive_style.zip?v=\").concat(1563278625)\n        });\n      }\n\n      var zipper = new _tools_zip__WEBPACK_IMPORTED_MODULE_4__[\"ZipFileCreator\"](outputList, httpOutputList, includeZips, 'application/epub+zip');\n      zipper.init().then(function (blob) {\n        return downloadjs__WEBPACK_IMPORTED_MODULE_0___default()(blob, Object(_tools_file__WEBPACK_IMPORTED_MODULE_2__[\"createSlug\"])(title) + '.epub', 'application/epub+zip');\n      });\n    }\n  }]);\n\n  return EpubExporter;\n}(_base__WEBPACK_IMPORTED_MODULE_7__[\"BaseEpubExporter\"]);\n\n//# sourceURL=webpack:///./js/modules/exporter/epub/index.js?");

/***/ }),

/***/ "./js/modules/exporter/epub/templates.js":
/*!***********************************************!*\
  !*** ./js/modules/exporter/epub/templates.js ***!
  \***********************************************/
/*! exports provided: opfTemplate, containerTemplate, ncxTemplate, ncxItemTemplate, xhtmlTemplate, navTemplate, navItemTemplate */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"opfTemplate\", function() { return opfTemplate; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"containerTemplate\", function() { return containerTemplate; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ncxTemplate\", function() { return ncxTemplate; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ncxItemTemplate\", function() { return ncxItemTemplate; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"xhtmlTemplate\", function() { return xhtmlTemplate; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"navTemplate\", function() { return navTemplate; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"navItemTemplate\", function() { return navItemTemplate; });\n/* harmony import */ var _mathlive_opf_includes__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../mathlive/opf_includes */ \"./js/modules/mathlive/opf_includes.js\");\n/* harmony import */ var _common__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../common */ \"./js/modules/common/index.js\");\n\n\n/** A template for the OPF file of an epub. */\n\nvar opfTemplate = function opfTemplate(_ref) {\n  var id = _ref.id,\n      idType = _ref.idType,\n      title = _ref.title,\n      language = _ref.language,\n      authors = _ref.authors,\n      keywords = _ref.keywords,\n      date = _ref.date,\n      modified = _ref.modified,\n      images = _ref.images,\n      styleSheets = _ref.styleSheets,\n      math = _ref.math;\n  return \"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?>\\n<package xmlns=\\\"http://www.idpf.org/2007/opf\\\" version=\\\"3.0\\\" unique-identifier=\\\"\".concat(idType, \"\\\" xml:lang=\\\"\").concat(language, \"\\\" prefix=\\\"cc: http://creativecommons.org/ns#\\\">\\n    <metadata xmlns:dc=\\\"http://purl.org/dc/elements/1.1/\\\">\\n        <dc:identifier id=\\\"\").concat(idType, \"\\\">\").concat(id, \"</dc:identifier>\\n            <dc:title>\").concat(Object(_common__WEBPACK_IMPORTED_MODULE_1__[\"escapeText\"])(title), \"</dc:title>\\n\").concat(authors.map(function (author) {\n    return \"\\t\\t<dc:creator>\".concat(Object(_common__WEBPACK_IMPORTED_MODULE_1__[\"escapeText\"])(author), \"</dc:creator>\\n\");\n  }).join(''), \"\\n\").concat(keywords.map(function (keyword) {\n    return \"\\t\\t<dc:subject>\".concat(Object(_common__WEBPACK_IMPORTED_MODULE_1__[\"escapeText\"])(keyword), \"</dc:subject>\\n\");\n  }).join(''), \"\\n        <dc:language>\").concat(language, \"</dc:language>\\n        <dc:date>\").concat(date, \"</dc:date>\\n        <meta property=\\\"dcterms:modified\\\">\").concat(modified, \"</meta>\\n    </metadata>\\n    <manifest>\\n        <item id=\\\"t1\\\" href=\\\"document.xhtml\\\" media-type=\\\"application/xhtml+xml\\\" />\\n        <item id=\\\"nav\\\" href=\\\"document-nav.xhtml\\\" properties=\\\"nav\\\" media-type=\\\"application/xhtml+xml\\\" />\\n\").concat(images.map(function (image, index) {\n    return \"\\t\\t\\t<item \".concat(image.coverImage ? 'id=\"cover-image\" properties=\"cover-image\"' : \"id=\\\"img\".concat(index, \"\\\"\"), \" href=\\\"\").concat(image.filename, \"\\\" media-type=\\\"image/\").concat(image.filename.split(\".\")[1] === \"png\" ? 'png' : image.filename.split(\".\")[1] === \"svg\" ? 'svg+xml' : 'jpeg', \"\\\" />\\n\");\n  }).join(''), \"\\n\").concat(styleSheets.map(function (sheet, index) {\n    return \"\\t\\t\\t<item id=\\\"css\".concat(index, \"\\\" href=\\\"\").concat(sheet.filename, \"\\\" media-type=\\\"text/css\\\" />\\n\");\n  }).join(''), \"\\n\").concat(math ? _mathlive_opf_includes__WEBPACK_IMPORTED_MODULE_0__[\"mathliveOpfIncludes\"] : '', \"\\n        <!-- ncx included for 2.0 reading system compatibility: -->\\n        <item id=\\\"ncx\\\" href=\\\"document.ncx\\\" media-type=\\\"application/x-dtbncx+xml\\\" />\\n    </manifest>\\n    <spine toc=\\\"ncx\\\">\\n        <itemref idref=\\\"t1\\\" />\\n    </spine>\\n</package>\");\n};\n/** A template for the contianer XML of an epub file. */\n\nvar containerTemplate = function containerTemplate() {\n  return \"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?>\\n<container xmlns=\\\"urn:oasis:names:tc:opendocument:xmlns:container\\\" version=\\\"1.0\\\">\\n    <rootfiles>\\n        <rootfile full-path=\\\"EPUB/document.opf\\\" media-type=\\\"application/oebps-package+xml\\\"/>\\n    </rootfiles>\\n</container>\";\n};\n/** A template of the NCX file of an epub. */\n\nvar ncxTemplate = function ncxTemplate(_ref2) {\n  var shortLang = _ref2.shortLang,\n      idType = _ref2.idType,\n      id = _ref2.id,\n      title = _ref2.title,\n      contentItems = _ref2.contentItems;\n  return \"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?>\\n<ncx xmlns:ncx=\\\"http://www.daisy.org/z3986/2005/ncx/\\\" xmlns=\\\"http://www.daisy.org/z3986/2005/ncx/\\\" version=\\\"2005-1\\\" xml:lang=\\\"\".concat(shortLang, \"\\\">\\n    <head>\\n        <meta name=\\\"dtb:\").concat(idType, \"\\\" content=\\\"\").concat(id, \"\\\"/>\\n    </head>\\n    <docTitle>\\n        <text>\").concat(Object(_common__WEBPACK_IMPORTED_MODULE_1__[\"escapeText\"])(title), \"</text>\\n    </docTitle>\\n    <navMap>\\n        <!-- 2.01 NCX: playOrder is optional -->\\n\").concat(contentItems.map(function (item) {\n    return ncxItemTemplate({\n      item: item\n    });\n  }).join(''), \"\\n    </navMap>\\n</ncx>\");\n};\n/** A template for each list item in the navMap of an epub's NCX file. */\n\nvar ncxItemTemplate = function ncxItemTemplate(_ref3) {\n  var item = _ref3.item;\n  return \"        <navPoint id=\\\"\".concat(item.docNum ? \"\".concat(item.id, \"-\").concat(item.docNum) : item.id, \"\\\">\\n            <navLabel><text>\").concat(Object(_common__WEBPACK_IMPORTED_MODULE_1__[\"escapeText\"])(item.title), \"</text></navLabel>\\n            <content src=\\\"\").concat(item.link ? item.link : item.docNum ? \"document-\".concat(item.docNum, \".xhtml#\").concat(item.id) : \"document.xhtml#\".concat(item.id), \"\\\"/>\\n\").concat(item.subItems.map(function (item) {\n    return ncxItemTemplate({\n      item: item\n    });\n  }).join(''), \"\\n        </navPoint>\\n\");\n};\n/** A template for a document in an epub. */\n\nvar xhtmlTemplate = function xhtmlTemplate(_ref4) {\n  var shortLang = _ref4.shortLang,\n      title = _ref4.title,\n      math = _ref4.math,\n      styleSheets = _ref4.styleSheets,\n      part = _ref4.part,\n      body = _ref4.body;\n  return \"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?>\\n<html xmlns=\\\"http://www.w3.org/1999/xhtml\\\" xml:lang=\\\"\".concat(shortLang, \"\\\" lang=\\\"\").concat(shortLang, \"\\\"\\n        xmlns:epub=\\\"http://www.idpf.org/2007/ops\\\">\\n    <head>\\n        <title>\").concat(Object(_common__WEBPACK_IMPORTED_MODULE_1__[\"escapeText\"])(title), \"</title>\\n\").concat(math ? '\\t\\t<link rel=\"stylesheet\" type=\"text/css\" href=\"mathlive.css\" />\\n' : '', \"\\n\").concat(styleSheets.map(function (sheet) {\n    return \"\\t\\t<link rel=\\\"stylesheet\\\" type=\\\"text/css\\\" href=\\\"\".concat(sheet.filename, \"\\\" />\\n\");\n  }).join(''), \"\\n    </head>\\n    <body>\\n\").concat(part && part.length ? \"\\t\\t<h1 class=\\\"part\\\">\".concat(Object(_common__WEBPACK_IMPORTED_MODULE_1__[\"escapeText\"])(part), \"</h1>\") : '', \"\\n        \").concat(body, \"\\n\\n    </body>\\n</html>\");\n};\n/** A template for an epub's navigation document. */\n\nvar navTemplate = function navTemplate(_ref5) {\n  var shortLang = _ref5.shortLang,\n      contentItems = _ref5.contentItems;\n  return \"<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?>\\n<html xmlns=\\\"http://www.w3.org/1999/xhtml\\\" xml:lang=\\\"\".concat(shortLang, \"\\\" lang=\\\"\").concat(shortLang, \"\\\" xmlns:epub=\\\"http://www.idpf.org/2007/ops\\\">\\n    <head>\\n        <meta charset=\\\"utf-8\\\"></meta>\\n    </head>\\n    <body>\\n        <nav epub:type=\\\"toc\\\" id=\\\"toc\\\">\\n            <ol>\\n\").concat(contentItems.map(function (item) {\n    return navItemTemplate({\n      item: item\n    });\n  }).join(''), \"\\n            </ol>\\n        </nav>\\n    </body>\\n</html>\");\n};\n/** A template for each item in an epub's navigation document. */\n\nvar navItemTemplate = function navItemTemplate(_ref6) {\n  var item = _ref6.item;\n  return \"\\t\\t\\t\\t<li><a href=\\\"\".concat(item.link ? item.link : item.docNum ? \"document-\".concat(item.docNum, \".xhtml#\").concat(item.id) : \"document.xhtml#\".concat(item.id), \"\\\">\").concat(Object(_common__WEBPACK_IMPORTED_MODULE_1__[\"escapeText\"])(item.title), \"</a>\\n\").concat(item.subItems.length ? \"<ol>\\n        \".concat(item.subItems.map(function (item) {\n    return navItemTemplate({\n      item: item\n    });\n  }).join(''), \"\\n    </ol>\") : '', \"\\n</li>\");\n};\n\n//# sourceURL=webpack:///./js/modules/exporter/epub/templates.js?");

/***/ }),

/***/ "./js/modules/exporter/tools/json.js":
/*!*******************************************!*\
  !*** ./js/modules/exporter/tools/json.js ***!
  \*******************************************/
/*! exports provided: obj2Node, node2Obj */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"obj2Node\", function() { return obj2Node; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"node2Obj\", function() { return node2Obj; });\n/** Same functionality as objToNode/nodeToObj in diffDOM.js, but also offers output in XHTML format (obj2Node) and without form support. */\nvar obj2Node = function obj2Node(obj, docType) {\n  var parser;\n\n  if (obj === undefined) {\n    return false;\n  }\n\n  if (docType === 'xhtml') {\n    parser = new window.DOMParser().parseFromString('<xml/>', \"text/xml\");\n  } else {\n    parser = document;\n  }\n\n  function inner(obj, insideSvg) {\n    var node;\n\n    if (obj.hasOwnProperty('t')) {\n      node = parser.createTextNode(obj.t);\n    } else if (obj.hasOwnProperty('co')) {\n      node = parser.createComment(obj.co);\n    } else {\n      if (obj.nn === 'svg' || insideSvg) {\n        node = parser.createElementNS('http://www.w3.org/2000/svg', obj.nn);\n        insideSvg = true;\n      } else if (obj.nn === 'script') {\n        // Do not allow scripts\n        return parser.createTextNode('');\n      } else {\n        node = parser.createElement(obj.nn);\n      }\n\n      if (obj.a) {\n        for (var i = 0; i < obj.a.length; i++) {\n          node.setAttribute(obj.a[i][0], obj.a[i][1]);\n        }\n      }\n\n      if (obj.c) {\n        for (var _i = 0; _i < obj.c.length; _i++) {\n          node.appendChild(inner(obj.c[_i], insideSvg));\n        }\n      }\n    }\n\n    return node;\n  }\n\n  return inner(obj);\n};\nvar node2Obj = function node2Obj(node) {\n  var obj = {};\n\n  if (node.nodeType === 3) {\n    obj.t = node.data;\n  } else if (node.nodeType === 8) {\n    obj.co = node.data;\n  } else {\n    obj.nn = node.nodeName;\n\n    if (node.attributes && node.attributes.length > 0) {\n      obj.a = [];\n\n      for (var i = 0; i < node.attributes.length; i++) {\n        obj.a.push([node.attributes[i].name, node.attributes[i].value]);\n      }\n    }\n\n    if (node.childNodes && node.childNodes.length > 0) {\n      obj.c = [];\n\n      for (var _i2 = 0; _i2 < node.childNodes.length; _i2++) {\n        if (node.childNodes[_i2]) {\n          obj.c.push(node2Obj(node.childNodes[_i2]));\n        }\n      }\n    }\n  }\n\n  return obj;\n};\n\n//# sourceURL=webpack:///./js/modules/exporter/tools/json.js?");

/***/ }),

/***/ "./js/modules/mathlive/opf_includes.js":
/*!*********************************************!*\
  !*** ./js/modules/mathlive/opf_includes.js ***!
  \*********************************************/
/*! exports provided: mathliveOpfIncludes */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"mathliveOpfIncludes\", function() { return mathliveOpfIncludes; });\n// This file is auto-generated. CHANGES WILL BE OVERWRITTEN! Re-generate by running ./manage.py bundle_mathlive.\nvar mathliveOpfIncludes = \"\\n<item id=\\\"mathlive-0\\\" href=\\\"mathlive.css\\\" media-type=\\\"text/css\\\" />\\n<item id=\\\"mathlive-1\\\" href=\\\"fonts/.DS_Store\\\" media-type=\\\"application/octet-stream\\\" />\\n<item id=\\\"mathlive-2\\\" href=\\\"fonts/KaTeX_Main-BoldItalic.woff2\\\" media-type=\\\"application/octet-stream\\\" />\\n<item id=\\\"mathlive-3\\\" href=\\\"fonts/KaTeX_Math-BoldItalic.woff\\\" media-type=\\\"application/octet-stream\\\" />\\n<item id=\\\"mathlive-4\\\" href=\\\"fonts/KaTeX_SansSerif-Regular.woff2\\\" media-type=\\\"application/octet-stream\\\" />\\n<item id=\\\"mathlive-5\\\" href=\\\"fonts/KaTeX_Main-Bold.woff2\\\" media-type=\\\"application/octet-stream\\\" />\\n<item id=\\\"mathlive-6\\\" href=\\\"fonts/KaTeX_Size2-Regular.woff2\\\" media-type=\\\"application/octet-stream\\\" />\\n<item id=\\\"mathlive-7\\\" href=\\\"fonts/KaTeX_SansSerif-Bold.woff2\\\" media-type=\\\"application/octet-stream\\\" />\\n<item id=\\\"mathlive-8\\\" href=\\\"fonts/KaTeX_Main-Regular.woff2\\\" media-type=\\\"application/octet-stream\\\" />\\n<item id=\\\"mathlive-9\\\" href=\\\"fonts/KaTeX_Size4-Regular.woff2\\\" media-type=\\\"application/octet-stream\\\" />\\n<item id=\\\"mathlive-10\\\" href=\\\"fonts/KaTeX_Size1-Regular.woff2\\\" media-type=\\\"application/octet-stream\\\" />\\n<item id=\\\"mathlive-11\\\" href=\\\"fonts/KaTeX_Math-Regular.woff2\\\" media-type=\\\"application/octet-stream\\\" />\\n<item id=\\\"mathlive-12\\\" href=\\\"fonts/KaTeX_SansSerif-Italic.woff2\\\" media-type=\\\"application/octet-stream\\\" />\\n<item id=\\\"mathlive-13\\\" href=\\\"fonts/KaTeX_Main-Bold.woff\\\" media-type=\\\"application/octet-stream\\\" />\\n<item id=\\\"mathlive-14\\\" href=\\\"fonts/KaTeX_AMS-Regular.woff\\\" media-type=\\\"application/octet-stream\\\" />\\n<item id=\\\"mathlive-15\\\" href=\\\"fonts/KaTeX_Size3-Regular.woff2\\\" media-type=\\\"application/octet-stream\\\" />\\n<item id=\\\"mathlive-16\\\" href=\\\"fonts/KaTeX_Script-Regular.woff\\\" media-type=\\\"application/octet-stream\\\" />\\n<item id=\\\"mathlive-17\\\" href=\\\"fonts/KaTeX_SansSerif-Italic.woff\\\" media-type=\\\"application/octet-stream\\\" />\\n<item id=\\\"mathlive-18\\\" href=\\\"fonts/KaTeX_Fraktur-Bold.woff\\\" media-type=\\\"application/octet-stream\\\" />\\n<item id=\\\"mathlive-19\\\" href=\\\"fonts/KaTeX_Main-Regular.woff\\\" media-type=\\\"application/octet-stream\\\" />\\n<item id=\\\"mathlive-20\\\" href=\\\"fonts/KaTeX_Fraktur-Regular.woff2\\\" media-type=\\\"application/octet-stream\\\" />\\n<item id=\\\"mathlive-21\\\" href=\\\"fonts/KaTeX_SansSerif-Regular.woff\\\" media-type=\\\"application/octet-stream\\\" />\\n<item id=\\\"mathlive-22\\\" href=\\\"fonts/KaTeX_Typewriter-Regular.woff\\\" media-type=\\\"application/octet-stream\\\" />\\n<item id=\\\"mathlive-23\\\" href=\\\"fonts/KaTeX_Size2-Regular.woff\\\" media-type=\\\"application/octet-stream\\\" />\\n<item id=\\\"mathlive-24\\\" href=\\\"fonts/KaTeX_AMS-Regular.woff2\\\" media-type=\\\"application/octet-stream\\\" />\\n<item id=\\\"mathlive-25\\\" href=\\\"fonts/KaTeX_Caligraphic-Bold.woff2\\\" media-type=\\\"application/octet-stream\\\" />\\n<item id=\\\"mathlive-26\\\" href=\\\"fonts/KaTeX_Math-BoldItalic.woff2\\\" media-type=\\\"application/octet-stream\\\" />\\n<item id=\\\"mathlive-27\\\" href=\\\"fonts/KaTeX_Typewriter-Regular.woff2\\\" media-type=\\\"application/octet-stream\\\" />\\n<item id=\\\"mathlive-28\\\" href=\\\"fonts/KaTeX_Caligraphic-Regular.woff2\\\" media-type=\\\"application/octet-stream\\\" />\\n<item id=\\\"mathlive-29\\\" href=\\\"fonts/KaTeX_SansSerif-Bold.woff\\\" media-type=\\\"application/octet-stream\\\" />\\n<item id=\\\"mathlive-30\\\" href=\\\"fonts/KaTeX_Script-Regular.woff2\\\" media-type=\\\"application/octet-stream\\\" />\\n<item id=\\\"mathlive-31\\\" href=\\\"fonts/KaTeX_Caligraphic-Regular.woff\\\" media-type=\\\"application/octet-stream\\\" />\\n<item id=\\\"mathlive-32\\\" href=\\\"fonts/KaTeX_Math-Italic.woff\\\" media-type=\\\"application/octet-stream\\\" />\\n<item id=\\\"mathlive-33\\\" href=\\\"fonts/KaTeX_Size1-Regular.woff\\\" media-type=\\\"application/octet-stream\\\" />\\n<item id=\\\"mathlive-34\\\" href=\\\"fonts/KaTeX_Math-Italic.woff2\\\" media-type=\\\"application/octet-stream\\\" />\\n<item id=\\\"mathlive-35\\\" href=\\\"fonts/KaTeX_Caligraphic-Bold.woff\\\" media-type=\\\"application/octet-stream\\\" />\\n<item id=\\\"mathlive-36\\\" href=\\\"fonts/KaTeX_Main-Italic.woff2\\\" media-type=\\\"application/octet-stream\\\" />\\n<item id=\\\"mathlive-37\\\" href=\\\"fonts/KaTeX_Main-Italic.woff\\\" media-type=\\\"application/octet-stream\\\" />\\n<item id=\\\"mathlive-38\\\" href=\\\"fonts/KaTeX_Math-Regular.woff\\\" media-type=\\\"application/octet-stream\\\" />\\n<item id=\\\"mathlive-39\\\" href=\\\"fonts/KaTeX_Size4-Regular.woff\\\" media-type=\\\"application/octet-stream\\\" />\\n<item id=\\\"mathlive-40\\\" href=\\\"fonts/KaTeX_Fraktur-Regular.woff\\\" media-type=\\\"application/octet-stream\\\" />\\n<item id=\\\"mathlive-41\\\" href=\\\"fonts/KaTeX_Size3-Regular.woff\\\" media-type=\\\"application/octet-stream\\\" />\\n<item id=\\\"mathlive-42\\\" href=\\\"fonts/KaTeX_Main-BoldItalic.woff\\\" media-type=\\\"application/octet-stream\\\" />\\n<item id=\\\"mathlive-43\\\" href=\\\"fonts/KaTeX_Fraktur-Bold.woff2\\\" media-type=\\\"application/octet-stream\\\" />\\n\";\n\n//# sourceURL=webpack:///./js/modules/mathlive/opf_includes.js?");

/***/ })

}]);